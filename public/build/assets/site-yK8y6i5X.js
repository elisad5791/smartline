var o,c;$(document).ready(function(){$("#map").length>0&&ymaps.ready(m)});function m(){const a=document.getElementById("map").offsetWidth;document.getElementById("map").style.height=a*.8+"px",o=new ymaps.Map("map",{center:[58,56.22],zoom:11});const e={fillColor:"rgba(0, 0, 0, 0.1)",strokeColor:"#0000FF",strokeWidth:2,strokeStyle:"solid"};var t=new ymaps.GeoObject({geometry:{type:"Polygon",coordinates:[[[58.004481,56.181631],[58.020273,56.252322],[57.999265,56.270446],[57.990337,56.233553],[58.004481,56.181631]]]}},e),d=new ymaps.GeoObject({geometry:{type:"Polygon",coordinates:[[[58.006341,56.124592],[58.035899,56.307232],[57.996768,56.335864],[57.967807,56.149503],[58.006341,56.124592]]]}},e),l=new ymaps.GeoObject({geometry:{type:"Polygon",coordinates:[[[58.006022,55.911359],[58.113861,56.297623],[58.113861,56.407623],[58.009988,56.367834],[57.96,56.307834],[57.933245,56.164821],[58.006022,55.911359]]]}},e);o.geoObjects.add(t),o.geoObjects.add(d),o.geoObjects.add(l),o.balloon.open([58,56.23],"Доставка - ближняя зона 200 руб., средняя зона 300 руб., дальняя зона 500 руб.");const r=$("[data-lon]").attr("data-lon"),n=$("[data-lat]").attr("data-lat");r&&n&&(c=new ymaps.Placemark([n,r],{balloonContent:"Адрес доставки"},{preset:"islands#icon",iconColor:"#0095b6"}),o.geoObjects.add(c))}const s=$("#address");$(document).on("change","input[name=delivery]",function(){if($(this).prop("checked")&&$(this).val()=="curier")s.prop("disabled",!1);else{s.prop("disabled",!0),s.val("");const e={_token:$('meta[name="csrf-token"]').attr("content")};$.ajax({url:"/cart/pickup",method:"POST",data:e,success:function(t){o.geoObjects.remove(c)},error:function(t){console.error(t)}})}});s.suggestions({token:"ff0900b6ba8078858b621fb551882f475d68f86c",type:"ADDRESS",onSelect:function(a){const e=a.data.geo_lat,t=a.data.geo_lon,d=s.val(),l=$('meta[name="csrf-token"]').attr("content"),r={lat:e,lon:t,address:d,_token:l};$.ajax({url:"/cart/delivery",method:"POST",data:r,success:function(n){c=new ymaps.Placemark([e,t],{balloonContent:"Адрес доставки"},{preset:"islands#icon",iconColor:"#0095b6"}),o.geoObjects.add(c)},error:function(n){console.error(n)}})}});
